{"version":3,"sources":["webpack:///src/app/pages/proof/proof.page.html","webpack:///src/app/pages/proof/proof-routing.module.ts","webpack:///src/app/pages/proof/proof.module.ts","webpack:///src/app/pages/proof/proof.page.scss","webpack:///src/app/pages/proof/proof.page.ts","webpack:///src/app/services/confirm-alert/confirm-alert.service.ts","webpack:///src/app/utils/type.ts"],"names":["routes","path","component","ProofPageRoutingModule","imports","forChild","exports","ProofPageModule","declarations","ProofPage","router","route","translocoService","alertController","confirmAlert","publishersAlert","proofRepository","captionRepository","informationRepository","signatureRepository","proof$","paramMap","pipe","params","get","hash","getByHash$","rawBase64$","proof","getRawFile$","hash$","mimeType$","mimeType","type","timestamp$","Date","timestamp","caption$","getByProof$","captions","length","text","providersWithInformationList$","informationList","providers","Set","map","information","provider","filter","signatures$","refresh$","subscribe","present$","onConfirm","remove$","navigate","captionInputName","caption","create","header","translate","inputs","name","value","placeholder","buttons","role","handler","saveCaption","alertElement","present","addOrEdit$","proofHash","checkProperties","selector","template","ConfirmAlert","message","providedIn","isNonNullable","source$","v","undefined"],"mappings":"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","file":"pages-proof-proof-module-es5.js","sourcesContent":["export default \"<ion-header *transloco=\\\"let t\\\">\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-button routerLink=\\\"..\\\" routerDirection=\\\"back\\\">\\n        <ion-icon slot=\\\"icon-only\\\" name=\\\"arrow-back\\\"></ion-icon>\\n      </ion-button>\\n    </ion-buttons>\\n    <ion-title>{{ t('proofDetails') }}</ion-title>\\n    <ion-buttons slot=\\\"end\\\">\\n      <ion-button (click)=\\\"publish()\\\">\\n        <ion-icon slot=\\\"icon-only\\\" name=\\\"cloud-upload\\\"></ion-icon>\\n      </ion-button>\\n      <ion-button (click)=\\\"remove()\\\">\\n        <ion-icon slot=\\\"icon-only\\\" name=\\\"trash\\\"></ion-icon>\\n      </ion-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content *transloco=\\\"let t\\\">\\n  <ion-img [src]=\\\"'data:image/*;base64,' + (rawBase64$ | async)\\\"></ion-img>\\n  <ion-list lines=\\\"none\\\">\\n    <ion-item>\\n      <ion-icon slot=\\\"start\\\" name=\\\"reader\\\"></ion-icon>\\n      <ion-label class=\\\"ion-text-wrap\\\">\\n        <h2>{{ t('caption') }}</h2>\\n        <p>{{ (caption$ | async) === '' ? '(' + ( t('nothingHere') ) + ')' : (caption$ | async) }}</p>\\n      </ion-label>\\n      <ion-button (click)=\\\"editCaption()\\\" slot=\\\"end\\\" fill=\\\"clear\\\" shape=\\\"round\\\">\\n        <ion-icon slot=\\\"icon-only\\\" name=\\\"create\\\"></ion-icon>\\n      </ion-button>\\n    </ion-item>\\n    <ion-item>\\n      <ion-icon slot=\\\"start\\\" name=\\\"information\\\"></ion-icon>\\n      <ion-label class=\\\"ion-text-wrap\\\">\\n        <h2>{{ t('hash') }}</h2>\\n        <p>{{ hash$ | async }}</p>\\n      </ion-label>\\n    </ion-item>\\n    <ion-item>\\n      <ion-icon slot=\\\"start\\\" name=\\\"image\\\"></ion-icon>\\n      <ion-label class=\\\"ion-text-wrap\\\">\\n        <h2>{{ t('mimeType') }}</h2>\\n        <p>{{ mimeType$ | async }}</p>\\n      </ion-label>\\n    </ion-item>\\n    <ion-item>\\n      <ion-icon slot=\\\"start\\\" name=\\\"time\\\"></ion-icon>\\n      <ion-label class=\\\"ion-text-wrap\\\">\\n        <h2>{{ t('timestamp') }}</h2>\\n        <p>{{ timestamp$ | async }}</p>\\n      </ion-label>\\n    </ion-item>\\n    <ion-list-header>\\n      <ion-label>\\n        <h2>{{ t('information') }}</h2>\\n      </ion-label>\\n    </ion-list-header>\\n    <ion-item>\\n      <ion-slides pager>\\n        <ion-slide *ngFor=\\\"let providerWithInformationList of (providersWithInformationList$ | async)\\\">\\n          <ion-card class=\\\"slide-card\\\">\\n            <ion-card-header>\\n              <ion-card-title>{{ providerWithInformationList.provider }}</ion-card-title>\\n            </ion-card-header>\\n            <ion-card-content>\\n              <ion-list>\\n                <ion-item *ngFor=\\\"let information of providerWithInformationList.informationList\\\">\\n                  <ion-label class=\\\"ion-text-wrap\\\">\\n                    <h3>{{ information.name }}</h3>\\n                    <p>{{ information.value }}</p>\\n                  </ion-label>\\n                </ion-item>\\n              </ion-list>\\n            </ion-card-content>\\n          </ion-card>\\n        </ion-slide>\\n      </ion-slides>\\n    </ion-item>\\n    <ion-list-header>\\n      <ion-label>\\n        <h2>{{ t('signatures') }}</h2>\\n      </ion-label>\\n    </ion-list-header>\\n    <ion-item>\\n      <ion-slides pager>\\n        <ion-slide *ngFor=\\\"let signature of (signatures$ | async)\\\">\\n          <ion-card class=\\\"slide-card\\\">\\n            <ion-card-header>\\n              <ion-card-title>{{ signature.provider }}</ion-card-title>\\n            </ion-card-header>\\n            <ion-card-content>\\n              <ion-list>\\n                <ion-item>\\n                  <ion-label class=\\\"ion-text-wrap\\\">\\n                    <h3>{{ t('signature') }}</h3>\\n                    <p>{{ signature.signature }}</p>\\n                  </ion-label>\\n                </ion-item>\\n                <ion-item>\\n                  <ion-label class=\\\"ion-text-wrap\\\">\\n                    <h3>{{ t('publicKey') }}</h3>\\n                    <p class=\\\"multiline\\\">{{ signature.publicKey }}</p>\\n                  </ion-label>\\n                </ion-item>\\n              </ion-list>\\n            </ion-card-content>\\n          </ion-card>\\n        </ion-slide>\\n      </ion-slides>\\n    </ion-item>\\n  </ion-list>\\n</ion-content>\";","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { ProofPage } from './proof.page';\n\nconst routes: Routes = [{\n  path: '',\n  component: ProofPage\n}];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ProofPageRoutingModule { }\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { IonicModule } from '@ionic/angular';\nimport { TranslocoModule } from '@ngneat/transloco';\nimport { ProofPageRoutingModule } from './proof-routing.module';\nimport { ProofPage } from './proof.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ProofPageRoutingModule,\n    TranslocoModule\n  ],\n  declarations: [ProofPage]\n})\nexport class ProofPageModule { }\n","export default \"ion-slides {\\n  width: 100%;\\n}\\n\\n.slide-card {\\n  width: 100%;\\n  margin-bottom: 35px;\\n}\\n\\n.multiline {\\n  white-space: pre-wrap;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL3J1bm5lci93b3JrL2NhcHR1cmUtbGl0ZS9jYXB0dXJlLWxpdGUvc3JjL2FwcC9wYWdlcy9wcm9vZi9wcm9vZi5wYWdlLnNjc3MiLCJzcmMvYXBwL3BhZ2VzL3Byb29mL3Byb29mLnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLFdBQUE7QUNDRjs7QURFQTtFQUNFLFdBQUE7RUFDQSxtQkFBQTtBQ0NGOztBREVBO0VBQ0UscUJBQUE7QUNDRiIsImZpbGUiOiJzcmMvYXBwL3BhZ2VzL3Byb29mL3Byb29mLnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbImlvbi1zbGlkZXMge1xuICB3aWR0aDogMTAwJTtcbn1cblxuLnNsaWRlLWNhcmQge1xuICB3aWR0aDogMTAwJTtcbiAgbWFyZ2luLWJvdHRvbTogMzVweDtcbn1cblxuLm11bHRpbGluZSB7XG4gIHdoaXRlLXNwYWNlOiBwcmUtd3JhcDtcbn1cbiIsImlvbi1zbGlkZXMge1xuICB3aWR0aDogMTAwJTtcbn1cblxuLnNsaWRlLWNhcmQge1xuICB3aWR0aDogMTAwJTtcbiAgbWFyZ2luLWJvdHRvbTogMzVweDtcbn1cblxuLm11bHRpbGluZSB7XG4gIHdoaXRlLXNwYWNlOiBwcmUtd3JhcDtcbn0iXX0= */\";","import { Component } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { AlertController } from '@ionic/angular';\nimport { TranslocoService } from '@ngneat/transloco';\nimport { UntilDestroy, untilDestroyed } from '@ngneat/until-destroy';\nimport { first, map, switchMap, switchMapTo } from 'rxjs/operators';\nimport { ConfirmAlert } from 'src/app/services/confirm-alert/confirm-alert.service';\nimport { CaptionRepository } from 'src/app/services/data/caption/caption-repository.service';\nimport { InformationRepository } from 'src/app/services/data/information/information-repository.service';\nimport { ProofRepository } from 'src/app/services/data/proof/proof-repository.service';\nimport { SignatureRepository } from 'src/app/services/data/signature/signature-repository.service';\nimport { PublishersAlert } from 'src/app/services/publisher/publishers-alert/publishers-alert.service';\nimport { isNonNullable } from 'src/app/utils/type';\n\n@UntilDestroy({ checkProperties: true })\n@Component({\n  selector: 'app-proof',\n  templateUrl: './proof.page.html',\n  styleUrls: ['./proof.page.scss'],\n})\nexport class ProofPage {\n\n  readonly proof$ = this.route.paramMap.pipe(\n    map(params => params.get('hash')),\n    isNonNullable(),\n    switchMap(hash => this.proofRepository.getByHash$(hash)),\n    isNonNullable()\n  );\n  readonly rawBase64$ = this.proof$.pipe(switchMap(proof => this.proofRepository.getRawFile$(proof)));\n  readonly hash$ = this.proof$.pipe(map(proof => proof.hash));\n  readonly mimeType$ = this.proof$.pipe(map(proof => proof.mimeType.type));\n  readonly timestamp$ = this.proof$.pipe(map(proof => new Date(proof.timestamp)));\n  readonly caption$ = this.proof$.pipe(\n    switchMap(proof => this.captionRepository.getByProof$(proof)),\n    map(captions => {\n      if (captions.length === 0 || captions[0].text.length === 0) { return ''; }\n      return captions[0].text;\n    })\n  );\n  readonly providersWithInformationList$ = this.proof$.pipe(\n    switchMap(proof => this.informationRepository.getByProof$(proof)),\n    map(informationList => {\n      const providers = new Set(informationList.map(information => information.provider));\n      return [...providers].map(provider => ({\n        provider,\n        informationList: informationList.filter(information => information.provider === provider)\n      }));\n    })\n  );\n  readonly signatures$ = this.proof$.pipe(\n    switchMap(proof => this.signatureRepository.getByProof$(proof))\n  );\n\n  constructor(\n    private readonly router: Router,\n    private readonly route: ActivatedRoute,\n    private readonly translocoService: TranslocoService,\n    private readonly alertController: AlertController,\n    private readonly confirmAlert: ConfirmAlert,\n    private readonly publishersAlert: PublishersAlert,\n    private readonly proofRepository: ProofRepository,\n    private readonly captionRepository: CaptionRepository,\n    private readonly informationRepository: InformationRepository,\n    private readonly signatureRepository: SignatureRepository\n  ) { }\n\n  ionViewWillEnter() {\n    this.proofRepository.refresh$().pipe(\n      switchMapTo(this.captionRepository.refresh$()),\n      switchMapTo(this.informationRepository.refresh$()),\n      switchMapTo(this.signatureRepository.refresh$()),\n      untilDestroyed(this)\n    ).subscribe();\n  }\n\n  publish() {\n    this.proof$.pipe(\n      first(),\n      switchMap(proof => this.publishersAlert.present$(proof)),\n      untilDestroyed(this)\n    ).subscribe();\n  }\n\n  remove() {\n    const onConfirm = () => this.proof$.pipe(\n      switchMap(proof => this.proofRepository.remove$(proof)),\n      switchMapTo(this.router.navigate(['..'])),\n      untilDestroyed(this)\n    ).subscribe();\n\n    return this.confirmAlert.present$(onConfirm).pipe(untilDestroyed(this)).subscribe();\n  }\n\n  editCaption() {\n    const captionInputName = 'captionInputName';\n    this.caption$.pipe(\n      first(),\n      switchMap(caption => this.alertController.create({\n        header: this.translocoService.translate('editCaption'),\n        inputs: [{\n          name: captionInputName,\n          type: 'text',\n          value: caption,\n          placeholder: this.translocoService.translate('nothingHere')\n        }],\n        buttons: [{\n          text: this.translocoService.translate('cancel'),\n          role: 'cancel'\n        }, {\n          text: this.translocoService.translate('ok'),\n          handler: (inputs) => this.saveCaption(inputs[captionInputName])\n        }]\n      })),\n      switchMap(alertElement => alertElement.present()),\n      untilDestroyed(this)\n    ).subscribe();\n  }\n\n  private saveCaption(text: string) {\n    this.proof$.pipe(\n      switchMap(proof => this.captionRepository.addOrEdit$({\n        proofHash: proof.hash,\n        text\n      })),\n      untilDestroyed(this)\n    ).subscribe();\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { AlertController } from '@ionic/angular';\nimport { TranslocoService } from '@ngneat/transloco';\nimport { defer } from 'rxjs';\nimport { switchMap } from 'rxjs/operators';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ConfirmAlert {\n\n  constructor(\n    private readonly alertController: AlertController,\n    private readonly translocoService: TranslocoService\n  ) { }\n\n  present$(onConfirm: () => void) {\n    return defer(() => this.alertController.create({\n      header: this.translocoService.translate('areYouSure'),\n      message: this.translocoService.translate('message.areYouSure'),\n      buttons: [{\n        text: this.translocoService.translate('cancel'),\n        role: 'cancel'\n      }, {\n        text: this.translocoService.translate('ok'),\n        handler: onConfirm\n      }]\n    })).pipe(\n      switchMap(alertElement => alertElement.present())\n    );\n  }\n}\n","import { Observable } from 'rxjs';\nimport { filter } from 'rxjs/operators';\n\nexport function isNonNullable<T>() {\n  return (source$: Observable<null | undefined | T>) => source$.pipe(\n    filter((v): v is NonNullable<T> => v !== null && v !== undefined)\n  );\n}\n"]}
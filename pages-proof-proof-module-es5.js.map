{"version":3,"sources":["webpack:///src/app/services/confirm-alert/confirm-alert.service.ts","webpack:///src/app/pages/proof/proof.page.scss","webpack:///src/app/pages/proof/proof.page.ts","webpack:///src/app/pages/proof/proof.module.ts","webpack:///src/app/pages/proof/proof.page.html","webpack:///src/app/pages/proof/proof-routing.module.ts","webpack:///src/app/services/blocking-action/blocking-action.service.ts"],"names":["ConfirmAlert","alertController","translocoService","onConfirm","create","header","translate","message","buttons","text","role","handler","pipe","alertElement","present","providedIn","ProofPage","router","route","confirmAlert","publishersAlert","proofRepository","captionRepository","informationRepository","signatureRepository","blockingActionService","proof$","paramMap","params","get","hash","getByHash$","base64Src$","proof","getRawFile$","rawBase64","hash$","mimeType$","timestamp$","Date","timestamp","caption$","getByProof$","caption","length","providersWithImportantInformation$","informationList","providers","Set","map","information","provider","filter","importance","signatures$","present$","subscribe","run$","remove$","navigate","captionInputName","inputs","name","type","value","placeholder","saveCaption","addOrEdit$","proofHash","checkProperties","selector","template","ProofPageModule","imports","declarations","routes","path","component","ProofPageRoutingModule","forChild","exports","BlockingActionService","loadingController","action$","opts","loading","_run$","err","dismiss","result","_"],"mappings":"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","file":"pages-proof-proof-module-es5.js","sourcesContent":["import { Injectable } from '@angular/core';\nimport { AlertController } from '@ionic/angular';\nimport { TranslocoService } from '@ngneat/transloco';\nimport { defer } from 'rxjs';\nimport { switchMap } from 'rxjs/operators';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ConfirmAlert {\n\n  constructor(\n    private readonly alertController: AlertController,\n    private readonly translocoService: TranslocoService\n  ) { }\n\n  present$(onConfirm: () => void) {\n    return defer(() => this.alertController.create({\n      header: this.translocoService.translate('areYouSure'),\n      message: this.translocoService.translate('message.areYouSure'),\n      buttons: [{\n        text: this.translocoService.translate('cancel'),\n        role: 'cancel'\n      }, {\n        text: this.translocoService.translate('ok'),\n        handler: onConfirm\n      }]\n    })).pipe(\n      switchMap(alertElement => alertElement.present())\n    );\n  }\n}\n","export default \"ion-slides {\\n  width: 100%;\\n}\\n\\n.slide-card {\\n  width: 100%;\\n  margin-bottom: 35px;\\n}\\n\\n.multiline {\\n  white-space: pre-wrap;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcGFnZXMvcHJvb2YvcHJvb2YucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsV0FBQTtBQUNGOztBQUVBO0VBQ0UsV0FBQTtFQUNBLG1CQUFBO0FBQ0Y7O0FBRUE7RUFDRSxxQkFBQTtBQUNGIiwiZmlsZSI6InNyYy9hcHAvcGFnZXMvcHJvb2YvcHJvb2YucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiaW9uLXNsaWRlcyB7XG4gIHdpZHRoOiAxMDAlO1xufVxuXG4uc2xpZGUtY2FyZCB7XG4gIHdpZHRoOiAxMDAlO1xuICBtYXJnaW4tYm90dG9tOiAzNXB4O1xufVxuXG4ubXVsdGlsaW5lIHtcbiAgd2hpdGUtc3BhY2U6IHByZS13cmFwO1xufVxuIl19 */\";","import { Component } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { AlertController } from '@ionic/angular';\nimport { TranslocoService } from '@ngneat/transloco';\nimport { UntilDestroy, untilDestroyed } from '@ngneat/until-destroy';\nimport { defer } from 'rxjs';\nimport { first, map, pluck, switchMap, switchMapTo } from 'rxjs/operators';\nimport { BlockingActionService } from 'src/app/services/blocking-action/blocking-action.service';\nimport { ConfirmAlert } from 'src/app/services/confirm-alert/confirm-alert.service';\nimport { CaptionRepository } from 'src/app/services/data/caption/caption-repository.service';\nimport { Importance } from 'src/app/services/data/information/information';\nimport { InformationRepository } from 'src/app/services/data/information/information-repository.service';\nimport { ProofRepository } from 'src/app/services/data/proof/proof-repository.service';\nimport { SignatureRepository } from 'src/app/services/data/signature/signature-repository.service';\nimport { PublishersAlert } from 'src/app/services/publisher/publishers-alert/publishers-alert.service';\nimport { isNonNullable } from 'src/app/utils/rx-operators';\n\n@UntilDestroy({ checkProperties: true })\n@Component({\n  selector: 'app-proof',\n  templateUrl: './proof.page.html',\n  styleUrls: ['./proof.page.scss'],\n})\nexport class ProofPage {\n\n  readonly proof$ = this.route.paramMap.pipe(\n    map(params => params.get('hash')),\n    isNonNullable(),\n    switchMap(hash => this.proofRepository.getByHash$(hash)),\n    isNonNullable()\n  );\n\n  readonly base64Src$ = this.proof$.pipe(\n    switchMap(proof => this.proofRepository.getRawFile$(proof)),\n    map(rawBase64 => `data:image/png;base64,${rawBase64}`)\n  );\n  readonly hash$ = this.proof$.pipe(pluck('hash'));\n  readonly mimeType$ = this.proof$.pipe(pluck('mimeType'));\n  readonly timestamp$ = this.proof$.pipe(map(proof => new Date(proof.timestamp)));\n  readonly caption$ = this.proof$.pipe(\n    switchMap(proof => this.captionRepository.getByProof$(proof)),\n    map(caption => {\n      if (caption && caption.text.length > 0) { return caption.text; }\n      return '';\n    })\n  );\n\n  readonly providersWithImportantInformation$ = this.proof$.pipe(\n    switchMap(proof => this.informationRepository.getByProof$(proof)),\n    map(informationList => {\n      const providers = new Set(informationList.map(information => information.provider));\n      return [...providers].map(provider => ({\n        provider,\n        informationList: informationList.filter(\n          information => information.provider === provider && information.importance === Importance.High\n        )\n      }));\n    })\n  );\n\n  readonly signatures$ = this.proof$.pipe(\n    switchMap(proof => this.signatureRepository.getByProof$(proof))\n  );\n\n  constructor(\n    private readonly router: Router,\n    private readonly route: ActivatedRoute,\n    private readonly translocoService: TranslocoService,\n    private readonly alertController: AlertController,\n    private readonly confirmAlert: ConfirmAlert,\n    private readonly publishersAlert: PublishersAlert,\n    private readonly proofRepository: ProofRepository,\n    private readonly captionRepository: CaptionRepository,\n    private readonly informationRepository: InformationRepository,\n    private readonly signatureRepository: SignatureRepository,\n    private readonly blockingActionService: BlockingActionService\n  ) { }\n\n  publish() {\n    this.proof$.pipe(\n      first(),\n      switchMap(proof => this.publishersAlert.present$(proof)),\n      untilDestroyed(this)\n    ).subscribe();\n  }\n\n  remove() {\n    const onConfirm = () => this.blockingActionService.run$(\n      this.proof$.pipe(\n        switchMap(proof => this.proofRepository.remove$(proof)),\n        switchMapTo(defer(() => this.router.navigate(['..'])))\n      ),\n      { message: this.translocoService.translate('processing') }\n    ).pipe(untilDestroyed(this)).subscribe();\n\n    return this.confirmAlert.present$(onConfirm).pipe(untilDestroyed(this)).subscribe();\n  }\n\n  editCaption() {\n    const captionInputName = 'captionInputName';\n    this.caption$.pipe(\n      first(),\n      switchMap(caption => this.alertController.create({\n        header: this.translocoService.translate('editCaption'),\n        inputs: [{\n          name: captionInputName,\n          type: 'text',\n          value: caption,\n          placeholder: this.translocoService.translate('nothingHere')\n        }],\n        buttons: [{\n          text: this.translocoService.translate('cancel'),\n          role: 'cancel'\n        }, {\n          text: this.translocoService.translate('ok'),\n          handler: (inputs) => this.saveCaption(inputs[captionInputName])\n        }]\n      })),\n      switchMap(alertElement => alertElement.present()),\n      untilDestroyed(this)\n    ).subscribe();\n  }\n\n  private saveCaption(text: string) {\n    this.proof$.pipe(\n      switchMap(proof => this.captionRepository.addOrEdit$({\n        proofHash: proof.hash,\n        text\n      })),\n      untilDestroyed(this)\n    ).subscribe();\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { IonicModule } from '@ionic/angular';\nimport { TranslocoModule } from '@ngneat/transloco';\nimport { ProofPageRoutingModule } from './proof-routing.module';\nimport { ProofPage } from './proof.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ProofPageRoutingModule,\n    TranslocoModule\n  ],\n  declarations: [ProofPage]\n})\nexport class ProofPageModule { }\n","export default \"<ion-header *transloco=\\\"let t\\\">\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-button [routerLink]=\\\"['/storage']\\\" routerDirection=\\\"back\\\">\\n        <ion-icon slot=\\\"icon-only\\\" name=\\\"arrow-back\\\"></ion-icon>\\n      </ion-button>\\n    </ion-buttons>\\n    <ion-title>{{ t('proofDetails') }}</ion-title>\\n    <ion-buttons slot=\\\"end\\\">\\n      <ion-button (click)=\\\"publish()\\\">\\n        <ion-icon slot=\\\"icon-only\\\" name=\\\"cloud-upload\\\"></ion-icon>\\n      </ion-button>\\n      <ion-button (click)=\\\"remove()\\\">\\n        <ion-icon slot=\\\"icon-only\\\" name=\\\"trash\\\"></ion-icon>\\n      </ion-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content *transloco=\\\"let t\\\">\\n  <img [src]=\\\"base64Src$ | async\\\" />\\n  <ion-list lines=\\\"none\\\">\\n    <ion-item>\\n      <ion-icon slot=\\\"start\\\" name=\\\"reader\\\"></ion-icon>\\n      <ion-label class=\\\"ion-text-wrap\\\">\\n        <h2>{{ t('caption') }}</h2>\\n        <p>{{ (caption$ | async) === '' ? '(' + ( t('nothingHere') ) + ')' : (caption$ | async) }}</p>\\n      </ion-label>\\n      <ion-button (click)=\\\"editCaption()\\\" slot=\\\"end\\\" fill=\\\"clear\\\" shape=\\\"round\\\">\\n        <ion-icon slot=\\\"icon-only\\\" name=\\\"create\\\"></ion-icon>\\n      </ion-button>\\n    </ion-item>\\n    <ion-item>\\n      <ion-icon slot=\\\"start\\\" name=\\\"information\\\"></ion-icon>\\n      <ion-label class=\\\"ion-text-wrap\\\">\\n        <h2>{{ t('hash') }}</h2>\\n        <p>{{ hash$ | async }}</p>\\n      </ion-label>\\n    </ion-item>\\n    <ion-item>\\n      <ion-icon slot=\\\"start\\\" name=\\\"image\\\"></ion-icon>\\n      <ion-label class=\\\"ion-text-wrap\\\">\\n        <h2>{{ t('mimeType') }}</h2>\\n        <p>{{ mimeType$ | async }}</p>\\n      </ion-label>\\n    </ion-item>\\n    <ion-item>\\n      <ion-icon slot=\\\"start\\\" name=\\\"time\\\"></ion-icon>\\n      <ion-label class=\\\"ion-text-wrap\\\">\\n        <h2>{{ t('timestamp') }}</h2>\\n        <p>{{ timestamp$ | async }}</p>\\n      </ion-label>\\n    </ion-item>\\n    <ion-list-header>\\n      <ion-label>\\n        <h2>{{ t('information') }}</h2>\\n      </ion-label>\\n    </ion-list-header>\\n    <ion-item>\\n      <ion-slides pager>\\n        <ion-slide>\\n          <ion-card class=\\\"slide-card\\\"\\n            *ngFor=\\\"let providerWithInformationList of (providersWithImportantInformation$ | async)\\\">\\n            <ion-card-header>\\n              <ion-card-title>{{ providerWithInformationList.provider }}</ion-card-title>\\n            </ion-card-header>\\n            <ion-card-content>\\n              <ion-list *ngFor=\\\"let information of providerWithInformationList.informationList\\\">\\n                <ion-item>\\n                  <ion-label class=\\\"ion-text-wrap\\\">\\n                    <h3>{{ information.name }}</h3>\\n                    <p>{{ information.value }}</p>\\n                  </ion-label>\\n                </ion-item>\\n              </ion-list>\\n              <section>\\n                <ion-button expand=\\\"block\\\" [routerLink]=\\\"['/information', {hash: (hash$ | async)}]\\\">{{ t('viewAll') }}\\n                </ion-button>\\n              </section>\\n            </ion-card-content>\\n          </ion-card>\\n        </ion-slide>\\n      </ion-slides>\\n    </ion-item>\\n    <ion-list-header>\\n      <ion-label>\\n        <h2>{{ t('signatures') }}</h2>\\n      </ion-label>\\n    </ion-list-header>\\n    <ion-item>\\n      <ion-slides pager>\\n        <ion-slide *ngFor=\\\"let signature of (signatures$ | async)\\\">\\n          <ion-card class=\\\"slide-card\\\">\\n            <ion-card-header>\\n              <ion-card-title>{{ signature.provider }}</ion-card-title>\\n            </ion-card-header>\\n            <ion-card-content>\\n              <ion-list>\\n                <ion-item>\\n                  <ion-label class=\\\"ion-text-wrap\\\">\\n                    <h3>{{ t('signature') }}</h3>\\n                    <p>{{ signature.signature }}</p>\\n                  </ion-label>\\n                </ion-item>\\n                <ion-item>\\n                  <ion-label class=\\\"ion-text-wrap\\\">\\n                    <h3>{{ t('publicKey') }}</h3>\\n                    <p class=\\\"multiline\\\">{{ signature.publicKey }}</p>\\n                  </ion-label>\\n                </ion-item>\\n              </ion-list>\\n            </ion-card-content>\\n          </ion-card>\\n        </ion-slide>\\n      </ion-slides>\\n    </ion-item>\\n  </ion-list>\\n</ion-content>\";","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { ProofPage } from './proof.page';\n\nconst routes: Routes = [{\n  path: '',\n  component: ProofPage\n}];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ProofPageRoutingModule { }\n","import { Injectable } from '@angular/core';\nimport { LoadingController } from '@ionic/angular';\nimport { LoadingOptions } from '@ionic/core';\nimport { defer, Observable, of, zip } from 'rxjs';\nimport { catchError, map, switchMap, switchMapTo } from 'rxjs/operators';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class BlockingActionService {\n\n  constructor(\n    private readonly loadingController: LoadingController\n  ) { }\n\n  run$<T>(action$: Observable<T>, opts: LoadingOptions) {\n    return defer(() => this.loadingController.create(opts)).pipe(\n      switchMap(loading => this._run$(action$, loading))\n    );\n  }\n\n  private _run$<T>(action$: Observable<T>, loading: HTMLIonLoadingElement) {\n    return defer(() => loading.present()).pipe(\n      switchMapTo(action$),\n      catchError(err => {\n        loading.dismiss();\n        throw err;\n      }),\n      switchMap(result => zip(defer(() => loading.dismiss()), of(result))),\n      map(([_, result]) => result)\n    );\n  }\n}\n"]}